<div class="tree-node-line">
  <span *ngIf="children" class="tree-expander icon" [ngClass]="{
    'icon-folder-open': expanded,
    'icon-folder': !expanded,
    'icon-disabled': disabled }"
    (click)='ExpandClick()'>
  </span>
  <span *ngIf="loading" class="icon icon-spinner icon-spin">
  </span>
  <span *ngIf="!template" (click)="onClickNodeCallback()" [innerHTML]="label" [class.disabled]="disabled" class="tree-node-label"></span>
  <div *ngIf="selectable && !loading" class="tree-node-checkbox">
    <div class="checkbox">
      <input type="checkbox" [ngModel]="selected" (click)="onClick()" [attr.disabled]="disabled">
      <label>
        &nbsp;
      </label>
    </div>
  </div>
  <span *ngIf="isSortable && !loading" atlui-sortable-handle></span>
</div>
<div class="sub-tree" *ngIf="children?.length" [hidden]="!expanded" [atlui-sortable-container]="children" [draggable]="false" [dropzones]="[sortableZones]">
  <atlui-tree-node *ngFor="let child of children; let i = index"
    [(expanded)]="child.expanded"
    [(selected)]="child.selected"
    [node]="child"
    [label]="child.label"
    [model]="child.model"
    [id]="child.id"
    [children]="child.children"
    [selectable]="child.selectable"
    [loading]=child.loading
    [template]="template"
    [depth]="depth+1"
    [disabled]="child.disabled"
    [sortableZones]="sortableZones"
    [nestedSortable]="nestedSortable"
    [isSortable]="isSortable"
    (expand)="expand.emit($event)"
    (collapse)="collapse.emit($event)"
    (select)="onSelect($event)"
    (onClickNode)="onClickNode.emit($event)"
    [atlui-sortable]="isSortable"
    [sortableIndex]="i"
    [dropzones]="[sortableZones]"
    [nested]="nestedSortable"
    (onDragStartCallback)="onDragCallback($event, i, true)"
    (onDragEndCallback)="onDragCallback($event, i, false)"
    (onDragEnterCallback)="onDragOver($event, true)"
    (onDragLeaveCallback)="onDragOver($event, false)"
    (onDropSuccessCallback)="updateTree()">
  </atlui-tree-node>
</div>
